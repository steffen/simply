<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simply</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <div id="app">
    <div class="top-row">
      <aside class="tasks-pane card">
        <div class="sidebar-header">
          <div class="sidebar-header-top">
            <div class="sidebar-header-title">
              <h1>Tasks</h1>
              <div id="updated-today" class="updated-today" aria-live="polite" title="Number of tasks with an update today"></div>
              <div id="daily-total" class="daily-total" aria-live="polite" title="Total tracked time today"></div>
            </div>
            <div class="header-actions">
              <button id="collapse-sidebar" type="button" class="btn icon-btn collapse-btn" title="Collapse task list" aria-label="Collapse task list">«</button>
              <form id="new-task-form" autocomplete="off">
                <button type="submit" class="btn icon-btn" title="Add task" aria-label="Add task">+</button>
              </form>
            </div>
          </div>
          <div class="filter-group" id="task-filters" role="tablist" aria-label="Task status filter">
            <button class="filter-btn active" data-filter="open" aria-selected="true">Open</button>
            <button class="filter-btn" data-filter="waiting" aria-selected="false">Waiting</button>
            <button class="filter-btn" data-filter="closed" aria-selected="false">Closed</button>
          </div>
        </div>
        <ul id="task-list" class="task-list"></ul>
      </aside>
      <main class="task-pane card">
        <div id="empty-state" class="empty">Select or add a task</div>
        <section id="task-view" class="task-view hidden">
          <header class="task-view-header">
            <div class="task-title-block">
              <h2 id="task-title"></h2>
              <div id="task-desired-outcome" class="task-desired-outcome" aria-live="polite" title="Desired outcome / definition of done"></div>
              <div id="task-daily-total" class="task-daily-total" aria-live="polite" title="Tracked today for this task"></div>
            </div>
            <div class="task-actions">
              <button id="mark-waiting" class="btn subtle" title="Toggle waiting">Waiting</button>
              <button id="mark-closed" class="btn subtle" title="Toggle closed">Close</button>
              <button id="delete-task" class="btn danger" title="Delete task">Delete</button>
            </div>
          </header>
          <form id="new-update-form" class="row">
            <textarea id="new-update" placeholder="Write an update..." rows="1" title="Press Cmd+Enter (Mac) or Ctrl+Enter to send; Enter for a new line"></textarea>
            <button type="submit" id="submit-update" class="btn update-btn" disabled>Update</button>
          </form>
            <ul id="updates" class="updates"></ul>
        </section>
      </main>
    </div>
    <div class="plan-row card" id="plans-section">
      <div class="plan-left">
        <div class="plans-header">Daily Plans</div>
        <ul class="plan-shortcuts" id="plan-shortcuts" aria-label="Daily plans">
          <li><button type="button" class="plan-shortcut" data-rel="yesterday" id="plan-yesterday"><span class="plan-label">Yesterday</span> <span class="plan-count" data-for="yesterday"></span><span class="plan-date" data-date-for="yesterday"></span></button></li>
          <li><button type="button" class="plan-shortcut" data-rel="today" id="plan-today"><span class="plan-label">Today</span> <span class="plan-count" data-for="today"></span><span class="plan-date" data-date-for="today"></span></button></li>
          <li><button type="button" class="plan-shortcut" data-rel="tomorrow" id="plan-tomorrow"><span class="plan-label">Tomorrow</span> <span class="plan-count" data-for="tomorrow"></span><span class="plan-date" data-date-for="tomorrow"></span></button></li>
        </ul>
      </div>
      <div class="plan-right">
        <ul id="plan-items" class="plan-items"></ul>
        <div id="plan-empty" class="plan-empty hidden">No items yet — add your first plan item.</div>
        <form id="new-plan-item-form" class="plan-add-row" autocomplete="off">
          <input id="new-plan-item" type="text" placeholder="Add planned item..." maxlength="500" />
          <button type="submit" id="add-plan-item-btn" class="btn primary" disabled>Add</button>
        </form>
      </div>
    </div>
  </div>

    <button id="expand-sidebar-float" type="button" class="expand-sidebar-float" aria-label="Expand task list" title="Expand task list">»</button>
    <!-- New Task Modal -->
    <div id="new-task-modal" class="modal-overlay hidden" aria-hidden="true">
      <div class="modal-panel" role="dialog" aria-modal="true" aria-labelledby="new-task-modal-title">
        <form id="new-task-modal-form" autocomplete="off">
          <div class="modal-header">
            <h2 id="new-task-modal-title">New Task</h2>
            <button type="button" class="modal-close-btn" aria-label="Close new task dialog">×</button>
          </div>
          <div class="modal-body">
            <label class="form-label" for="new-task-title">Title</label>
            <input id="new-task-title" name="title" type="text" maxlength="200" required placeholder="Task title..." />
            <label class="form-label" for="new-task-outcome">Desired outcome (optional)</label>
            <input id="new-task-outcome" name="desired_outcome" type="text" maxlength="1000" placeholder="Definition of done..." />
          </div>
          <div class="modal-footer">
            <button type="button" class="btn subtle" id="cancel-new-task">Cancel</button>
            <button type="submit" class="btn primary" id="create-new-task" disabled>Create Task</button>
          </div>
        </form>
      </div>
    </div>
    <!-- Markdown libraries: load BEFORE app.js so they're available during initial render -->
    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.2/marked.min.js" integrity="sha256-I0CSExGzCs8IO5IrHg8wABZ8lq/zBtTDUA3axHB3cx0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.9/dist/purify.min.js" integrity="sha256-g9RCEYvGCNuTkeRLFioILAWMyJU8SA6RqgDb3m0cDHw=" crossorigin="anonymous"></script>
    <script src="/app.js"></script>
</body>
</html>
